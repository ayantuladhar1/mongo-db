# Assesment
## Sample Data
The following sample data was generated by youtube.
```json
{
  "kind": "youtube#searchListResponse",
  "etag": "\"m2yskBQFythfE4irbTIeOgYYfBU/PaiEDiVxOyCWelLPuuwa9LKz3Gk\"",
  "nextPageToken": "CAUQAA",
  "regionCode": "KE",
  "pageInfo": {
    "totalResults": 4249,
    "resultsPerPage": 5
  },
  "items": [
    {
      "kind": "youtube#searchResult",
      "etag": "\"m2yskBQFythfE4irbTIeOgYYfBU/QpOIr3QKlV5EUlzfFcVvDiJT0hw\"",
      "id": {
        "kind": "youtube#channel",
        "channelId": "UCJowOS1R0FnhipXVqEnYU1A"
      }
    },
    {
      "kind": "youtube#searchResult",
      "etag": "\"m2yskBQFythfE4irbTIeOgYYfBU/AWutzVOt_5p1iLVifyBdfoSTf9E\"",
      "id": {
        "kind": "youtube#video",
        "videoId": "Eqa2nAAhHN0"
      }
    },
    {
      "kind": "youtube#searchResult",
      "etag": "\"m2yskBQFythfE4irbTIeOgYYfBU/2dIR9BTfr7QphpBuY3hPU-h5u-4\"",
      "id": {
        "kind": "youtube#video",
        "videoId": "IirngItQuVs"
      }
    }
  ]
}
```

## Expectation: Use commands to perform operations such as insertOne() method
insertOne()method

<img width="944" height="1159" alt="image" src="https://github.com/user-attachments/assets/f962e41a-d922-4ee6-8b65-f94fc51d8085" />
<img width="760" height="461" alt="image" src="https://github.com/user-attachments/assets/b9607fbb-0e32-40e9-9c47-6094bf5ad887" />

## Use the MongoDB Command to return the only regionCode for only those docs where channelId is UCJowOS1R0FnhipXVqEnYU1A
For the above scenario, we have to use find() method as it takes two arguments: the first one is **WHERE** clause and second is Column projection such as **SELECT** clause. Since MongoDB always returns the **_id** by default and we just want to display the regionCode we would use **_id:0**

<img width="1020" height="228" alt="image" src="https://github.com/user-attachments/assets/e08be3d8-662b-45ed-a879-0caa45f5d06f" />

## Write a PySpark Code to read the document int odpark dataframe.
* Pyspark Code to return the only regionCode for only those docs where channelId is **UCJowOS1R0FnhipXVqEnYU1A**
  * First, we have to install pyspack connector using the following commands:  
    * pyspark --packages  
    * org.mongodb.spark:mongo-spark-connector_2.12:3.0.1
* We would use the following command to read the cluster, collections from MongoDB to PySpark
  * df = spark.read.format("com.mongodb.spark.sql.DefaultSource").option("uri", "mongodb+srv://{username}:{password}@cluster0.mpuo02w.mongodb.net/youtubedb.youtube").load()

<img width="1876" height="588" alt="image" src="https://github.com/user-attachments/assets/b6eefc4b-8d16-44b5-ad81-b64b1491c724" />
* To fetch the **regionCode** based on channelId we cannot simply use, **df.select("regionCode").filter("items.id.channelId = 'UCJowOS1R0FnhipXVqEnYU1A'").show()**, 
